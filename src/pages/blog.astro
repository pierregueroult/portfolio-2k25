---
import BlogItem from "../components/BlogItem.astro";
import Layout from "../layouts/Layout.astro";
import ListLayout from "../layouts/ListLayout.astro";
import WithTitleLayout from "../layouts/WithTitleLayout.astro";
import { excludeDrafts } from "../utils/excluse-drafts";
import { getCollection } from "astro:content";

const postsList = await getCollection("blog");

const posts = postsList.filter(excludeDrafts).sort((a, b) => {
  return new Date(b.data.date).getTime() - new Date(a.data.date).getTime();
});
---

<Layout
  title="Blog"
  description="Read my latest articles, thoughts, and tech tutorials. I write about web development, software engineering, automation, and tech culture."
>
  <WithTitleLayout
    title="Blog - Insights & Experiments"
    subtitle="Exploring web development, automation, and new technologiesâ€”one project at a time."
  >
    <ListLayout title="Articles">
      {
        posts.map((post) => (
          <BlogItem
            title={post.data.title}
            slug={post.data.slug}
            summary={post.data.summary}
            date={post.data.date}
            tags={post.data.tags}
          />
        ))
      }
    </ListLayout>
  </WithTitleLayout>
</Layout>
